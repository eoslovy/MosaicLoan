from pyspark.sql.types import StructType, StructField, LongType, IntegerType, DoubleType, StringType

# DataFrame 스키마 정의
prediction_schema = StructType([
    StructField("case_id", LongType(), True),
    StructField("children_count", IntegerType(), True),
    StructField("dependents", DoubleType(), True),
    StructField("other_income", DoubleType(), True),
    StructField("employment_years", DoubleType(), True),
    StructField("house_type", StringType(), True),
    StructField("gender", StringType(), True),
    StructField("is_married", IntegerType(), True),
    StructField("age", LongType(), True),
    StructField("main_income", DoubleType(), True),
    StructField("total_income", DoubleType(), True),
    StructField("income_level", IntegerType(), True),
    StructField("job_stability_score", DoubleType(), True),
    StructField("dependents_per_income", DoubleType(), True),
    StructField("industry", StringType(), True),
    StructField("industry_stability_weight", DoubleType(), True),
    StructField("income_stability", DoubleType(), True),
    StructField("family_composition_score", DoubleType(), True),
    StructField("has_debit_card", IntegerType(), True),
    StructField("month_sin_prep", DoubleType(), True),
    StructField("month_cos_prep", DoubleType(), True),
    StructField("week_sin_prep", DoubleType(), True),
    StructField("week_cos_prep", DoubleType(), True),
    StructField("quarter_sin_prep", DoubleType(), True),
    StructField("quarter_cos_prep", DoubleType(), True),
    StructField("days30_165L_prep", DoubleType(), True),
    StructField("days90_310L_prep", DoubleType(), True),
    StructField("days120_123L_prep", DoubleType(), True),
    StructField("days180_256L_prep", DoubleType(), True),
    StructField("days360_512L_prep", DoubleType(), True),
    StructField("avginstallast24m_3658937A_prep", DoubleType(), True),
    StructField("avgoutstandbalancel6m_4187114A_prep", DoubleType(), True),
    StructField("avgpmtlast12m_4525200A_prep", DoubleType(), True),
    StructField("cntpmts24_3658933L_prep", DoubleType(), True),
    StructField("sumoutstandtotal_3546847A_prep", DoubleType(), True),
    StructField("days_since_last_delinq_prep", DoubleType(), True),
    StructField("days_since_response_prep", DoubleType(), True),
    StructField("short_to_long_term_ratio_prep", DoubleType(), True),
    StructField("mid_to_long_term_ratio_prep", DoubleType(), True),
    StructField("payment_frequency_prep", DoubleType(), True),
    StructField("payment_to_balance_ratio_prep", DoubleType(), True),
    StructField("installment_to_balance_ratio_prep", DoubleType(), True),
    StructField("short_term_debt_burden_prep", DoubleType(), True),
    StructField("long_term_debt_burden_prep", DoubleType(), True),
    StructField("weighted_default_rate_prep", DoubleType(), True),
    StructField("default_rate_volatility_prep", DoubleType(), True),
    StructField("default_rate_zscore_prep", DoubleType(), True),
    StructField("trend_reversal_prep", DoubleType(), True),
    StructField("default_acceleration_prep", DoubleType(), True),
    StructField("risk_composite_prep", DoubleType(), True),
    StructField("daily_default_rate_prep", DoubleType(), True),
    StructField("default_rate_ma7_prep", DoubleType(), True),
    StructField("default_rate_ma30_prep", DoubleType(), True),
    StructField("default_rate_std7_prep", DoubleType(), True),
    StructField("default_rate_change_prep", DoubleType(), True),
    StructField("numinstpaidearly3d_3546850L", DoubleType(), True),
    StructField("numinstpaidearly5d_1087L", DoubleType(), True),
    StructField("numinstlswithdpd10_728L", DoubleType(), True),
    StructField("numinstlswithdpd5_4187116L", DoubleType(), True),
    StructField("numinstlswithoutdpd_562L", DoubleType(), True),
    StructField("pctinstlsallpaidearl3d_427L", DoubleType(), True),
    StructField("pctinstlsallpaidlat10d_839L", DoubleType(), True),
    StructField("last180dayturnover_1134A", DoubleType(), True),
    StructField("last30dayturnover_651A", DoubleType(), True),
    StructField("amtdebitincoming_4809443A", DoubleType(), True),
    StructField("amtdebitoutgoing_4809440A", DoubleType(), True),
    StructField("credacc_transactions_402L", DoubleType(), True),
    StructField("raw_behavior_score", DoubleType(), True),
    StructField("behavior_score", DoubleType(), True),
    StructField("payment_consistency", DoubleType(), True),
    StructField("good_payment_ratio", DoubleType(), True),
    StructField("early_to_late_payment_ratio", DoubleType(), True),
    StructField("behavior_score_diff", DoubleType(), True),
    StructField("severe_late_payment_ratio", DoubleType(), True),
    StructField("transaction_activity_ratio", DoubleType(), True),
    StructField("cash_flow_health", DoubleType(), True),
    StructField("behavior_score_binned", IntegerType(), True),
    StructField("risk_indicator", DoubleType(), True),
    StructField("behavior_payment_alignment", DoubleType(), True),
    StructField("avgdbddpdlast24m_3658932P", DoubleType(), True),
    StructField("avgdbddpdlast3m_4187120P", DoubleType(), True),
    StructField("avgmaxdpdlast9m_3716943P", DoubleType(), True),
    StructField("maxdpdlast6m_474P", DoubleType(), True),
    StructField("dpdmax_139P", DoubleType(), True),
    StructField("dpdmax_757P", DoubleType(), True),
    StructField("overdueamount_31A", DoubleType(), True),
    StructField("overdueamount_659A", DoubleType(), True),
    StructField("totaldebtoverduevalue_178A", DoubleType(), True),
    StructField("totaloutstanddebtvalue_39A", DoubleType(), True),
    StructField("debtpastduevalue_732A", DoubleType(), True),
    StructField("overdue_outstanding_ratio", DoubleType(), True),
    StructField("recent_dpd_change_ratio", DoubleType(), True),
    StructField("short_term_dpd_ratio", DoubleType(), True),
    StructField("active_closed_dpd_ratio", DoubleType(), True),
    StructField("active_closed_overdue_ratio", DoubleType(), True),
    StructField("severe_dpd_last6m_flag", IntegerType(), True),
    StructField("increasing_dpd_flag", IntegerType(), True),
    StructField("overdue_amount_category", IntegerType(), True),
    StructField("debt_burden_category", IntegerType(), True),
    StructField("dpd_amount_interaction", DoubleType(), True),
    StructField("recent_dpd_squared", DoubleType(), True),
    StructField("long_short_dpd_interaction", DoubleType(), True),
    StructField("composite_credit_risk", DoubleType(), True),
    StructField("composite_debt_risk", DoubleType(), True),
    StructField("dpd_worsening_rate", DoubleType(), True),
    StructField("long_short_term_dpd_diff", DoubleType(), True),
    StructField("dpd_volatility", DoubleType(), True),
    StructField("dpd_pyramid_index", IntegerType(), True),
    StructField("credit_shock_indicator", IntegerType(), True),
    StructField("debt_concentration_ratio", DoubleType(), True),
    StructField("delinquency_severity_index", DoubleType(), True),
    StructField("cyclical_delinquency_pattern", IntegerType(), True),
    StructField("log_outstanding_debt", DoubleType(), True),
    StructField("log_overdue_debt", DoubleType(), True),
    StructField("exp_recent_dpd", DoubleType(), True),
    StructField("ensemble_risk_score", DoubleType(), True),
    StructField("credit_resilience", DoubleType(), True),
    StructField("delinquency_entropy_proxy", DoubleType(), True),
    StructField("dpd_acceleration", DoubleType(), True),
    StructField("projected_dpd", DoubleType(), True),
    StructField("debt_elasticity", DoubleType(), True),
    StructField("target", LongType(), True)
])